"0","set.seed(431)"
"0",""
"0","predict.regsubsets = function(object, newdata, id, ...){"
"0","  form = as.formula(object$call[[2]])"
"0","  mat = model.matrix(form, newdata)"
"0","  coefi = coef(object, id=id)"
"0","  xvars = names(coefi)"
"0","  mat[,xvars]%*%coefi"
"0","}"
"0",""
"0","k = 10"
"0",""
"0","set.seed(431)"
"0","folds = sample(1:k, nrow(train), replace = TRUE)"
"0","cv.errors = matrix(NA, k, 8, dimnames = list(NULL, paste(1:8)))"
"0",""
"0",""
"0","for(j in 1:k){"
"0","  best.fit = regsubsets(BWT~., data = train[folds!=j,], nvmax = 8)"
"0","  for (i in 1:8){"
"0","    pred = predict(best.fit, train[folds==j,], id=i)"
"0","    cv.errors[j,i]=mean((train$BWT[folds==j]-pred)^2)"
"0","  }"
"0","}"
"0",""
"0","mean.cv.errors = apply(cv.errors, 2, mean)"
"0","par(mfrow=c(1,1))"
"0","plot(mean.cv.errors, type = 'b')"
